#:set containerWidth 0.669
#:set bubbleSizeY 0.045

<Wall@Image>:

<Popup>:
	size:app.window.height * (containerWidth + 0.02), app.window.height *0.6

# Sets the styling for the labels that contains lives, points and  level
<TableLabel>:
	canvas.before:
	    Color:
	    	rgb: 1,1,1
		Rectangle:
			size: self.size
			pos:self.x - 10, self.y
			source: 'graphics/column.png'
	color: 0,0,0,1
	font_size: 18
	bold: True
	text_size: self.size
	valign:'middle'

# Shooter description:

<Shooter>:
    source: 'graphics/shooter.png'
    canvas.before:
        PushMatrix
        Rotate:
            axis: 0,0,1
            angle: self.shooterTowerAngle
            origin: self.center
    canvas.after:
        PopMatrix


# Bubble description:
<Bubble>:
	size:app.window.height * 0.05, app.window.height * 0.05
	#size: 35 / (1200.0 / app.window.height), 35 / (1200.0 / app.window.height)
	size_hint: None, None
	pos: 50,50


# Threat description:
<Threat>:
	id: threatId
	size_hint: None, None
	keep_data: True
    size:(app.window.height * 0.05) * 3.1, (app.window.height * 0.05) * 3.1
	
	p1: self.pos
    p2: self.right, self.y
    p3: self.center_x, self.top * 0.98

    # draw something
    canvas:
        Color:
            rgba: 1, 0, 0, 0
        Triangle:
            points: self.p1 + self.p2 + self.p3
    Image:
    	source:threatId.imageSrc
    	size:threatId.size
    	pos:threatId.pos

	

# Main widget description:
<DbShooterWidget>:
	id: DbShooterWidget
	shooter: shooter

	Image:
	    source: 'graphics/background.jpg'
        allow_stretch: True
        keep_ratio: False
        size: app.window.size
   

	# Widget where all the obsticles (bubbles, threats) will be and where all the new bubbles will be added::
	FloatLayout:
		id: bubbleLayout
		canvas:
			Color:
	            rgba: 1, 1, 1, 0.15
	        Rectangle:
	            pos: self.pos
	            size: self.size

		pos_hint:None, None
		pos:(root.width-self.width)/2, root.y + root.height * (bubbleSizeY * 4.6) 
	    size_hint:None, None
	    height: root.height
	    width: root.height * containerWidth
	
	#the walls
	Wall:
		id:leftWall
		size:50, root.height
		pos:bubbleLayout.x - self.width, root.y		
	Wall:
		id:rightWall
		size:50, root.height
		pos:bubbleLayout.x + bubbleLayout.width, root.y	


	# the grid for all the bubbles
	FloatLayout:
		opacity:0.2
		id: bubbleGrid
		pos_hint:None, None
		pos:(root.width-self.width)/2, root.y + root.height * (bubbleSizeY * 4.6)
	    size_hint:None, None
	    height: root.height
	    width: root.height * containerWidth

	#this defines the base on which the shooter stands (with level, table/database image etc) 
	BoxLayout:
		id: databaseWidget
		height: root.height *0.2
		width: bubbleLayout.width *0.8
		bottom: root.height
		size_hint: None, None
		pos: bubbleLayout.pos
		canvas:
			Rectangle:
	            size: self.width, self.height
	            pos: root.width *0.5 - self.width *0.5, 0
	            source: 'graphics/table.png'

	#This is the wrapper for level, and points etc
	BoxLayout:
		height:root.height *0.16
		width:bubbleLayout.width *0.7
		bottom: root.height 
		size_hint:None, None
		pos: root.width *0.5 - self.width *0.5, 0
		#canvas:
		#	Color:
		#		rgb:0,0,1
		#	Rectangle:
	    #        size: self.width, self.height
	    #        pos: root.width *0.5 - self.width *0.5, 0
	    FloatLayout:
	    	id: nextBubbleLayout
	    		
	    #this defines the level, points and lives
	    GridLayout:
	    	cols:2
	    	padding:20
	    	spacing:10,10
	    	#lives
	    	TableLabel:
	    		text: 'Lives'
	    		
	    	TableLabel:
				id: livesLbl
		        text: str(DbShooterWidget.lives)
		    #points
		    TableLabel:
	    		text: 'Points'
		    TableLabel:
		        id: pointsLbl
		        text:  str(DbShooterWidget.points) #str(DbShooterWidget.lives)

		    #level
		    TableLabel:
	    		text: 'Level'
		    TableLabel:
		        text: str(root.level)
	FloatLayout:
		id: shooterLayout
		pos_hint:None, None
		pos:(root.width-self.width)/2, root.y 
	    size_hint:None, None
	    height: root.height
	    width: root.height * containerWidth

		Shooter:
			id: shooter
			pos_hint: {'center_x':0.5, 'center_y':0.29}
			size_hint:0.14,0.14

		Image:
			id: db
			source: 'graphics/db.png'
			size_hint:0.18,0.18
			pos_hint: {'center_x':0.5, 'center_y':0.24}

<Button>:
	font_size:43

# decripes the buttons inside the question-popup	
<QuestionButton>:
	font_size:15
	text_size:int(self.width * 0.8), None
	#halign:'right'


